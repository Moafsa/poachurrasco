<!DOCTYPE html>
<html>
<head>
    <title>Teste Google Maps API</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        #map { width: 100%; height: 400px; border: 1px solid #ccc; }
        .info { margin: 20px 0; padding: 15px; background: #f0f0f0; border-radius: 5px; }
        .error { background: #ffe0e0; color: #c00; }
        .success { background: #e0ffe0; color: #060; }
    </style>
</head>
<body>
    <h1>Teste da Chave Google Maps API</h1>
    <div class="info">
        <strong>Chave sendo testada:</strong> <span id="apiKey">AIzaSyC_YPzGTDVX3HCgXBx-l6lBoXUsX7Z5HeU</span>
    </div>
    <div id="status" class="info">Carregando...</div>
    <div id="map"></div>

    <script>
        const apiKey = 'AIzaSyC_YPzGTDVX3HCgXBx-l6lBoXUsX7Z5HeU';
        const statusDiv = document.getElementById('status');

        // Handler de erro de autenticação
        window.gm_authFailure = function() {
            statusDiv.className = 'info error';
            statusDiv.innerHTML = '<strong>❌ ERRO DE AUTENTICAÇÃO</strong><br>' +
                'A chave da API está inválida ou não tem as permissões necessárias.<br>' +
                'Verifique no Google Cloud Console se:<br>' +
                '1. A API "Maps JavaScript API" está habilitada<br>' +
                '2. A chave não tem restrições de HTTP referrer bloqueando este domínio<br>' +
                '3. A chave está ativa';
        };

        // Handler de inicialização
        function initMap() {
            try {
                const map = new google.maps.Map(document.getElementById('map'), {
                    center: { lat: -30.0346, lng: -51.2177 },
                    zoom: 13
                });
                statusDiv.className = 'info success';
                statusDiv.innerHTML = '<strong>✅ SUCESSO!</strong><br>O mapa foi carregado corretamente. A chave da API está funcionando.';
            } catch (error) {
                statusDiv.className = 'info error';
                statusDiv.innerHTML = '<strong>❌ ERRO ao inicializar o mapa:</strong><br>' + error.message;
            }
        }

        // Verificar erros no carregamento do script
        window.addEventListener('error', function(e) {
            if (e.message && (e.message.includes('google') || e.message.includes('maps'))) {
                statusDiv.className = 'info error';
                statusDiv.innerHTML = '<strong>❌ ERRO ao carregar o script:</strong><br>' + e.message;
            }
        }, true);

        // Carregar o script
        const script = document.createElement('script');
        script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&callback=initMap`;
        script.async = true;
        script.defer = true;
        script.onerror = function() {
            statusDiv.className = 'info error';
            statusDiv.innerHTML = '<strong>❌ ERRO ao carregar o script do Google Maps</strong><br>' +
                'Verifique sua conexão com a internet ou se a URL da API está correta.';
        };
        document.head.appendChild(script);
    </script>
</body>
</html>
